<body>
    <h2 class="mt-2">Adicionar Imovel</h2>
    <form action="/imovel/editar/<%- imovelCompleto[0].imovel.id %>" method="POST" enctype="multipart/form-data">
        <%- console.log("/imovel/editar/" + imovelCompleto[0].imovel.id ) %>
        <div class="mt-3">
            <input type="text" class="form-control" name="descricao" placeholder="Descricao" value="<%- imovelCompleto[0].imovel.descricao %>">
        </div>
        <div class="mt-3">
            <input type="text" class="form-control" name="telefone" placeholder="Telefone" value="<%- imovelCompleto[0].imovel.telefone %>">
        </div>
        <div class="mt-3">
            <input type="text" class="form-control" name="valor" placeholder="Valor" value="<%- imovelCompleto[0].imovel.valor %>">
        </div>
        <div class="mt-3">
            <input type="text" class="form-control" name="cep" id="cep" placeholder="CEP" value="<%- imovelCompleto[0].endereco.cep %>">
        </div>
        <div class="mt-3">
            <input type="text" class="form-control" name="estado" placeholder="Estado" value="<%- imovelCompleto[0].endereco.estado %>">
        </div>
        <div class="mt-3">
            <input type="text" class="form-control" name="cidade" placeholder="Cidade" value="<%- imovelCompleto[0].endereco.cidade %>">
        </div>
        <div class="mt-3">
            <input type="text" class="form-control" name="bairro" placeholder="Bairro" value="<%- imovelCompleto[0].endereco.bairro %>">
        </div>
        <div class="mt-3">
            <input type="text" class="form-control" name="rua" placeholder="Rua" value="<%- imovelCompleto[0].endereco.rua %>">
        </div>
        <div class="mt-3">
            <input type="text" class="form-control" name="numero" placeholder="Numero" value="numero">
        </div>
        <div class="mt-3">
            <input type="file" class="form-control" name="arquivo" multiple>
        </div>
        <div class="mt-3">
            <button type="submit" class="btn btn-dark">Atualizar imóvel</button>
        </div>
      </form>
</body>
<script>
    document.querySelector('#cep').addEventListener('blur', function () {
        const cep = this.value;
    
        fetch(`https://viacep.com.br/ws/${cep}/json/`)
          .then((response) => response.json())
          .then((data) => {
            document.querySelector('input[name="estado"]').value = data.uf;
            document.querySelector('input[name="cidade"]').value = data.localidade;
            document.querySelector('input[name="bairro"]').value = data.bairro;
            document.querySelector('input[name="rua"]').value = data.logradouro;
          })
          .catch((error) => {
            console.error('Erro ao buscar o endereço:', error);
          });
      });
</script>